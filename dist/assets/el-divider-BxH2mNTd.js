import{h as K,l as L,_ as Q,k as ut,w as tt,L as ft}from"./base-iFpej8ky.js";import{d as F,c,b as j,e as G,s as dt,f as q,u as R,a as et,n as nt,z as at,x as J,r as vt,m as pt,w as gt,o as mt}from"./index-ChCffZU7.js";const ht=K({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:L(String),default:"solid"}}),xt=F({name:"ElDivider"}),yt=F({...xt,props:ht,setup(o){const n=o,s=ut("divider"),r=c(()=>s.cssVar({"border-style":n.borderStyle}));return(i,p)=>(G(),j("div",{class:q([R(s).b(),R(s).m(i.direction)]),style:nt(R(r)),role:"separator"},[i.$slots.default&&i.direction!=="vertical"?(G(),j("div",{key:0,class:q([R(s).e("text"),R(s).is(i.contentPosition)])},[et(i.$slots,"default")],2)):dt("v-if",!0)],6))}});var bt=Q(yt,[["__file","divider.vue"]]);const Et=tt(bt),_t=K({zIndex:{type:Number,default:9},rotate:{type:Number,default:-22},width:Number,height:Number,image:String,content:{type:L([String,Array]),default:"Element Plus"},font:{type:L(Object)},gap:{type:L(Array),default:()=>[100,100]},offset:{type:L(Array)}});function St(o){return o.replace(/([A-Z])/g,"-$1").toLowerCase()}function $t(o){return Object.keys(o).map(n=>`${St(n)}: ${o[n]};`).join(" ")}function Mt(){return window.devicePixelRatio||1}const wt=(o,n)=>{let s=!1;return o.removedNodes.length&&n&&(s=Array.from(o.removedNodes).includes(n)),o.type==="attributes"&&o.target===n&&(s=!0),s},ot=3;function Y(o,n,s=1){const r=document.createElement("canvas"),i=r.getContext("2d"),p=o*s,B=n*s;return r.setAttribute("width",`${p}px`),r.setAttribute("height",`${B}px`),i.save(),[i,r,p,B]}function kt(){function o(n,s,r,i,p,B,T,O){const[h,H,x,k]=Y(i,p,r);if(n instanceof HTMLImageElement)h.drawImage(n,0,0,x,k);else{const{color:v,fontSize:w,fontStyle:E,fontWeight:P,fontFamily:st,textAlign:lt,textBaseline:it}=B,U=Number(w)*r;h.font=`${E} normal ${P} ${U}px/${p}px ${st}`,h.fillStyle=v,h.textAlign=lt,h.textBaseline=it;const V=at(n)?n:[n];V==null||V.forEach((Z,ct)=>{h.fillText(Z??"",x/2,ct*(U+ot*r))})}const y=Math.PI/180*Number(s),D=Math.max(i,p),[I,X,g]=Y(D,D,r);I.translate(g/2,g/2),I.rotate(y),x>0&&k>0&&I.drawImage(H,-x/2,-k/2);function f(v,w){const E=v*Math.cos(y)-w*Math.sin(y),P=v*Math.sin(y)+w*Math.cos(y);return[E,P]}let b=0,C=0,W=0,N=0;const A=x/2,_=k/2;[[0-A,0-_],[0+A,0-_],[0+A,0+_],[0-A,0+_]].forEach(([v,w])=>{const[E,P]=f(v,w);b=Math.min(b,E),C=Math.max(C,E),W=Math.min(W,P),N=Math.max(N,P)});const t=b+g/2,e=W+g/2,a=C-b,d=N-W,m=T*r,S=O*r,z=(a+m)*2,$=d+S,[M,l]=Y(z,$);function u(v=0,w=0){M.drawImage(X,t,e,a,d,v,w,a,d)}return u(),u(a+m,-d/2-S/2),u(a+m,+d/2+S/2),[l.toDataURL(),z/r,$/r]}return o}const zt=F({name:"ElWatermark"}),Bt=F({...zt,props:_t,setup(o){const n=o,s={position:"relative"},r=c(()=>{var t,e;return(e=(t=n.font)==null?void 0:t.color)!=null?e:"rgba(0,0,0,.15)"}),i=c(()=>{var t,e;return(e=(t=n.font)==null?void 0:t.fontSize)!=null?e:16}),p=c(()=>{var t,e;return(e=(t=n.font)==null?void 0:t.fontWeight)!=null?e:"normal"}),B=c(()=>{var t,e;return(e=(t=n.font)==null?void 0:t.fontStyle)!=null?e:"normal"}),T=c(()=>{var t,e;return(e=(t=n.font)==null?void 0:t.fontFamily)!=null?e:"sans-serif"}),O=c(()=>{var t,e;return(e=(t=n.font)==null?void 0:t.textAlign)!=null?e:"center"}),h=c(()=>{var t,e;return(e=(t=n.font)==null?void 0:t.textBaseline)!=null?e:"hanging"}),H=c(()=>n.gap[0]),x=c(()=>n.gap[1]),k=c(()=>H.value/2),y=c(()=>x.value/2),D=c(()=>{var t,e;return(e=(t=n.offset)==null?void 0:t[0])!=null?e:k.value}),I=c(()=>{var t,e;return(e=(t=n.offset)==null?void 0:t[1])!=null?e:y.value}),X=()=>{const t={zIndex:n.zIndex,position:"absolute",left:0,top:0,width:"100%",height:"100%",pointerEvents:"none",backgroundRepeat:"repeat"};let e=D.value-k.value,a=I.value-y.value;return e>0&&(t.left=`${e}px`,t.width=`calc(100% - ${e}px)`,e=0),a>0&&(t.top=`${a}px`,t.height=`calc(100% - ${a}px)`,a=0),t.backgroundPosition=`${e}px ${a}px`,t},g=J(null),f=J(),b=vt(!1),C=()=>{f.value&&(f.value.remove(),f.value=void 0)},W=(t,e)=>{var a;g.value&&f.value&&(b.value=!0,f.value.setAttribute("style",$t({...X(),backgroundImage:`url('${t}')`,backgroundSize:`${Math.floor(e)}px`})),(a=g.value)==null||a.append(f.value),setTimeout(()=>{b.value=!1}))},N=t=>{let e=120,a=64;const d=n.image,m=n.content,S=n.width,z=n.height;if(!d&&t.measureText){t.font=`${Number(i.value)}px ${T.value}`;const $=at(m)?m:[m],M=$.map(l=>{const u=t.measureText(l);return[u.width,u.fontBoundingBoxAscent!==void 0?u.fontBoundingBoxAscent+u.fontBoundingBoxDescent:u.actualBoundingBoxAscent+u.actualBoundingBoxDescent]});e=Math.ceil(Math.max(...M.map(l=>l[0]))),a=Math.ceil(Math.max(...M.map(l=>l[1])))*$.length+($.length-1)*ot}return[S??e,z??a]},A=kt(),_=()=>{const e=document.createElement("canvas").getContext("2d"),a=n.image,d=n.content,m=n.rotate;if(e){f.value||(f.value=document.createElement("div"));const S=Mt(),[z,$]=N(e),M=l=>{const[u,v]=A(l||"",m,S,z,$,{color:r.value,fontSize:i.value,fontStyle:B.value,fontWeight:p.value,fontFamily:T.value,textAlign:O.value,textBaseline:h.value},H.value,x.value);W(u,v)};if(a){const l=new Image;l.onload=()=>{M(l)},l.onerror=()=>{M(d)},l.crossOrigin="anonymous",l.referrerPolicy="no-referrer",l.src=a}else M(d)}};return pt(()=>{_()}),gt(()=>n,()=>{_()},{deep:!0,flush:"post"}),mt(()=>{C()}),ft(g,t=>{b.value||t.forEach(e=>{wt(e,f.value)&&(C(),_())})},{attributes:!0,subtree:!0,childList:!0}),(t,e)=>(G(),j("div",{ref_key:"containerRef",ref:g,style:nt([s])},[et(t.$slots,"default")],4))}});var Ct=Q(Bt,[["__file","watermark.vue"]]);const Pt=tt(Ct);export{Pt as E,Et as a};
